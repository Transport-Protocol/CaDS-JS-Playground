/*
 playground 2017-08-16 
*/

"use strict";var __extends=this&&this.__extends||function(t,r){function s(){this.constructor=t}for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e]);t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)},isFunction_1=require("./util/isFunction"),Subscription_1=require("./Subscription"),Observer_1=require("./Observer"),rxSubscriber_1=require("./symbol/rxSubscriber"),Subscriber=function(t){function r(s,e,i){switch(t.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=Observer_1.empty;break;case 1:if(!s){this.destination=Observer_1.empty;break}if("object"==typeof s){s instanceof r?(this.destination=s,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new SafeSubscriber(this,s));break}default:this.syncErrorThrowable=!0,this.destination=new SafeSubscriber(this,s,e,i)}}return __extends(r,t),r.prototype[rxSubscriber_1.rxSubscriber]=function(){return this},r.create=function(t,s,e){var i=new r(t,s,e);return i.syncErrorThrowable=!1,i},r.prototype.next=function(t){this.isStopped||this._next(t)},r.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},r.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},r.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},r.prototype._next=function(t){this.destination.next(t)},r.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},r.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},r.prototype._unsubscribeAndRecycle=function(){var t=this,r=t._parent,s=t._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=r,this._parents=s,this},r}(Subscription_1.Subscription);exports.Subscriber=Subscriber;var SafeSubscriber=function(t){function r(r,s,e,i){t.call(this),this._parentSubscriber=r;var n,o=this;isFunction_1.isFunction(s)?n=s:s&&(n=s.next,e=s.error,i=s.complete,s!==Observer_1.empty&&(o=Object.create(s),isFunction_1.isFunction(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=n,this._error=e,this._complete=i}return __extends(r,t),r.prototype.next=function(t){if(!this.isStopped&&this._next){var r=this._parentSubscriber;r.syncErrorThrowable?this.__tryOrSetError(r,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},r.prototype.error=function(t){if(!this.isStopped){var r=this._parentSubscriber;if(this._error)r.syncErrorThrowable?(this.__tryOrSetError(r,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else{if(!r.syncErrorThrowable)throw this.unsubscribe(),t;r.syncErrorValue=t,r.syncErrorThrown=!0,this.unsubscribe()}}},r.prototype.complete=function(){var t=this;if(!this.isStopped){var r=this._parentSubscriber;if(this._complete){var s=function(){return t._complete.call(t._context)};r.syncErrorThrowable?(this.__tryOrSetError(r,s),this.unsubscribe()):(this.__tryOrUnsub(s),this.unsubscribe())}else this.unsubscribe()}},r.prototype.__tryOrUnsub=function(t,r){try{t.call(this._context,r)}catch(t){throw this.unsubscribe(),t}},r.prototype.__tryOrSetError=function(t,r,s){try{r.call(this._context,s)}catch(r){return t.syncErrorValue=r,t.syncErrorThrown=!0,!0}return!1},r.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},r}(Subscriber);